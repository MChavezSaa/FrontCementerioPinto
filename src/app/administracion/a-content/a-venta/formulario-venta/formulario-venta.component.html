<!--
 <label for="" class="col-sm-6"> funcionarioList</label> &nbsp;
                        

-->

<div class="container">

    <!--MIGAS DE PAN-->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-white pl-0">
            <li class="breadcrumb-item"><a [routerLink]="['/administracion-inicio']" href="#">Inicio</a></li>
            <li class="breadcrumb-item"><a [routerLink]="['/administracion-inicio/formularioVenta']"
                    (click)="cancelarVenta()" href="#">Ventas</a></li>
            <li class="breadcrumb-item active" aria-current="page">Formulario Ventas</li>
        </ol>
    </nav>
    <!--FIN MIGAS DE PAN-->

    <legend style="font-style: oblique"><b> Formulario Venta Derecho</b> </legend>
    <hr style="color: black">
    <div class="container">
        <form [formGroup]="formContrato" novalidate>
            <div class="separacion" style="text-align: center">
                <h4> &nbsp; Datos Compra</h4>
            </div>
            &nbsp;

            <div class="form-group">
                <div class="row">
                    <div class="col">
                        <label> Nombre Funcionario</label>
                        <select id="func" name="funcionario" class="form-control" formControlName="funcionario" [(ngModel)]="contrato2.funcionario">
                            <option [ngValue]="0" disabled selected>Seleccione Funcionario</option>
                            <option *ngFor="let c of funcionarioList" [ngValue]="c">{{c.nombres_Funcionario}}</option>
                        </select>
                        <div *ngIf="formContrato.get('funcionario').value==0 && 
                            (formContrato.get('funcionario').touched || formContrato.get('funcionario').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un funcionario.
                        </div>
                    </div>
                    <div class="col">
                        <label for="fecha_Ingreso_Venta"> Fecha Ingreso de venta</label>
                        <input id="fecha_Ingreso_Venta" class="form-control" type="date" name="fecha_Ingreso_Venta"
                            formControlName="fecha_Ingreso_Venta" [(ngModel)]="contrato2.fecha_Ingreso_Venta">
                        <div *ngIf="formContrato.get('fecha_Ingreso_Venta').hasError('required') && 
                              (formContrato.get('fecha_Ingreso_Venta').touched || formContrato.get('fecha_Ingreso_Venta').dirty)"
                            class="alert alert-danger">
                            Seleccione una fecha para el ingreso de la venta.
                        </div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <div class="row">
                    <div class="col">
                        <label> Cementerio</label>
                        <select id="cen" name="cementerio" class="form-control" formControlName="cementerio" [(ngModel)]="contrato2.cementerio">
                            <option [ngValue]="0" disabled selected>Seleccione Cementerio</option>
                            <option *ngFor="let cem of cementerioList" [ngValue]="cem">{{cem.nombre_Cementerio}}
                            </option>
                        </select>
                        <div *ngIf="formContrato.get('cementerio').value==0 && 
                            (formContrato.get('cementerio').touched || formContrato.get('cementerio').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un cementerio.
                        </div>
                    </div>
                    <div class="col">
                        <label> Terreno</label>
                        <select class="form-control" id="terr" name="terreno" formControlName="terreno" [(ngModel)]="contrato2.terreno">
                            <option [ngValue]="0" disabled selected>Seleccione Terreno </option>
                            <option *ngFor="let ter of terrenoList" [ngValue]="ter">{{ter.nombre_Terreno}}</option>
                        </select>
                        <div *ngIf="formContrato.get('terreno').value==0 && 
                            (formContrato.get('terreno').touched || formContrato.get('terreno').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un terreno.
                        </div>
                    </div>
                </div>

            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col">
                        <label> Nombre de Patio</label>
                        <select class="form-control" id="pat" name="patio" formControlName="patio" [(ngModel)]="contrato2.patio"
                            (change)="fun(contrato2.patio.id_Patio)">
                            <option [ngValue]="0" disabled selected>Seleccione Patio </option>
                            <option *ngFor="let c of patioList" [ngValue]="c">{{c.nombre_Patio}}</option>
                        </select>
                        <div *ngIf="formContrato.get('patio').value==0 && 
                            (formContrato.get('patio').touched || formContrato.get('patio').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un patio.
                        </div>
                    </div>

                    <div class="col">
                        <label> Tipo de Tumba</label>
                        <select class="form-control" id="tipoTumb" name="tipoTumba" formControlName="tipoTumba" [(ngModel)]="contrato2.tipoTumba"
                            (change)="doble1(contrato2.tipoTumba)">
                            <option [ngValue]="0" disabled selected>Seleccione tipo de tumba </option>
                            <option *ngFor="let c of tipoTumbaList " [ngValue]="c">{{c.nombretipo_tumba}}</option>
                        </select>
                        <div *ngIf="formContrato.get('tipoTumba').value==0 && 
                            (formContrato.get('tipoTumba').touched || formContrato.get('tipoTumba').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un tipo de tumba.
                        </div>
                    </div>
                    <div class="col" *ngIf="paraNicho">
                    
                        <label> Nivel de Nicho </label>&nbsp;<label *ngIf="paraNicho"></label>
                        <select class="form-control" id="tumb" name="tumba" formControlName="nivelNicho" [(ngModel)]="nivelNicho" 
                        (change)="mostrarNichos(contrato2.nivel)" >
                            <option [ngValue]="0" disabled selected>Seleccione un nivel para el nicho</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                        </select>
                        <div *ngIf="formContrato.get('nivelNicho').hasError('required') && 
                            (formContrato.get('nivelNicho').touched || formContrato.get('nivelNicho').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un nivel para el nicho.
                        </div>
                        <!-- Agregar validacion con numeros solo con estado cero -->
                    </div>

                    <div class="col" *ngIf="!paraNicho">

                        <label> Número de Tumba </label>&nbsp;<label *ngIf="doble">1</label>
                        <select class="form-control" id="tumb" name="tumba" formControlName="tumba1" [(ngModel)]="tumba1">
                            <option [ngValue]="0" disabled selected>Seleccione un número de Tumba </option>
                            <option *ngFor="let l of tumbaListAux " [ngValue]="l">{{l.numero_Tumba}}</option>
                        </select>
                        <div *ngIf="formContrato.get('tumba1').hasError('required') && 
                            (formContrato.get('tumba1').touched || formContrato.get('tumba1').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un número de tumba.
                        </div>
                        <!-- Agregar validacion con numeros solo con estado cero (change)="fun(contrato2.patio.id_Patio)"-->
                    </div>

                    <div class="col" *ngIf="doble">

                        <label> Número de Tumba </label>&nbsp;<label *ngIf="doble">2</label>
                        <select class="form-control" id="tumb" name="tumba" formControlName="tumba2" [(ngModel)]="tumba2">
                            <option [ngValue]="0" disabled selected>Seleccione un número de Tumba </option>
                            <option *ngFor="let lc of tumbaListAux " [ngValue]="lc">{{lc.numero_Tumba}}</option>
                        </select>
                        <div *ngIf="formContrato.get('tumba2').hasError('required') && 
                            (formContrato.get('tumba2').touched || formContrato.get('tumba2').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un segundo número de tumba.
                        </div>
                        <!-- Agregar validacion con numeros solo con estado cero -->
                    </div>
                    <div class="col" *ngIf="paraNicho">
                        <label> Número de Nicho</label>&nbsp;<label *ngIf="paraNicho"></label>
                        <select class="form-control" id="tumb" name="nicho" formControlName="numeroNicho" [(ngModel)]="numeroNicho" (change)="mostrarNichos(contrato2.nivel)">
                            <option [ngValue]="0" disabled selected>Seleccione un número de Tumba </option>
                            <option *ngFor="let l of nichoList " [ngValue]="l">{{l.numero_Tumba}}</option>
                        </select>
                        <div *ngIf="formContrato.get('numeroNicho').hasError('required') && 
                            (formContrato.get('numeroNicho').touched || formContrato.get('numeroNicho').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un número para el nicho.
                        </div>
                    </div>
                </div>
            </div>

            <div class="separacion" style="text-align: center">
                <h4> &nbsp; Datos Cliente</h4>
            </div>
            &nbsp;

            <div class="form-group">
                <div class="row">
                    <div class="col-4">
                        <label> Rut Cliente</label>
                        <select class="form-control" id="cliente1" name="cliente" formControlName="cliente" [(ngModel)]="contrato2.cliente"
                            (change)="mostrarClientes()">
                            <option [ngValue]="0" disabled selected>Seleccione Cliente </option>
                            <option *ngFor="let x of clienteList" [ngValue]="x">{{x.rut_Cliente}}</option>
                        </select>
                        <div *ngIf="formContrato.get('cliente').value==0 && 
                            (formContrato.get('cliente').touched || formContrato.get('cliente').dirty) "
                            class="alert alert-danger">
                            Es obligatorio seleccionar un Cliente.
                        </div>
                    </div>
                    <div class="col-6" *ngIf="mostrarCliente">
                        <label> Nombre Cliente</label>
                        <input [disabled]="true" class="form-control" type="text" for=""
                            value="{{contrato2.cliente.nombres_Cliente}} {{contrato2.cliente.apellidoP_Cliente}} {{contrato2.cliente.apellidoM_Cliente}}">
                        <!--
                        <div class="row" *ngIf="mostrarCliente">
                            <label for="">Nombre Cliente:  {{contrato2.cliente.nombres_Cliente}} {{contrato2.cliente.apellidoP_Cliente}} {{contrato2.cliente.apellidoM_Cliente}}</label>
                        </div>-->
                    </div>
                </div>
            </div>

            <div class="separacion" style="text-align: center">
                <h4> &nbsp; Datos de Pago</h4>
            </div>
            &nbsp;

            <div class="form-group">
                <div class="row">
                    <div class="col">
                        <label for="exampleFormControlSelect1"> Medio de Pago</label>
                        <select class="form-control" id="medioPago" name="medio_Pago"
                            formControlName="medio_Pago" [(ngModel)]="contrato2.medio_Pago">
                            <option [ngValue]="0" disabled selected>Seleccione medio de pago </option>
                            <option> Efectivo</option>
                            <option> Debito</option>
                            <option> Crédito</option>
                        </select>
                        <div *ngIf="formContrato.get('medio_Pago').value==0 && 
                            (formContrato.get('medio_Pago').touched || formContrato.get('medio_Pago').dirty)"
                            class="alert alert-danger">
                            Seleccione un medio de pago.
                        </div>
                        <!-- Agregar validacion con numeros solo con estado cero -->
                    </div>
                    <div class="col">
                        <label> Valor Terreno</label>
                        <input type="number" class="form-control" id="valorDerecho" name="valor_Terreno"
                            placeholder="Ingrese el valor del derecho" formControlName="valor_Terreno" [(ngModel)]="contrato2.valor_Terreno">
                            <div *ngIf="formContrato.get('valor_Terreno').hasError('required') && 
                                (formContrato.get('valor_Terreno').touched || formContrato.get('valor_Terreno').dirty)"
                                class="alert alert-danger">
                                El valor del terreno es obligatorio.
                            </div>
                    </div>

                    <div class="col">
                        <label> Pago inicial</label>
                        <input type="number" class="form-control" id="valorPagoInicial" name="pagoInicial"
                            placeholder="Ingrese el valor del pago inicial" formControlName="pagoInicial" [(ngModel)]="contrato2.pagoInicial">
                            <div *ngIf="formContrato.get('pagoInicial').hasError('required') && 
                                (formContrato.get('pagoInicial').touched || formContrato.get('pagoInicial').dirty)"
                                class="alert alert-danger">
                                El valor del pago inicial es obligatorio.
                            </div>
                    </div>

                </div>
            </div>

            <div class="form-group">
                <div class="row">
                    <div class="col-4">
                        <label> Número de Cuotas</label>
                        <input type="number" class="form-control" id="nroCuotas" name="nCuotas"
                            placeholder="Ingrese número de cuotas" formControlName="n_Cuotas" [(ngModel)]="contrato2.n_Cuotas"
                            (change)="mostrarCuotas()">
                            <div *ngIf="formContrato.get('n_Cuotas').hasError('required') && 
                                (formContrato.get('n_Cuotas').touched || formContrato.get('n_Cuotas').dirty)"
                                class="alert alert-danger">
                                El número de cuotas es obligatorio.
                            </div>
                    </div>
                    <div class="col-2">
                        <div class="row">
                            <label style="color: white"> _____________</label>
                        </div>
                        <div class="row" *ngIf="mostrarCuota">
                            <label for="">{{calcularValorCuota()}}</label>
                        </div>
                    </div>

                    <div class="col-6">
                        <label> Valor Cuota:</label>
                        <div>
                            <h1>{{show?'': returnCuota()}}</h1>
                        </div>


                    </div>

                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class="col-4">
                        <label> Dia para fecha de pago</label>
                        <input type="date" class="form-control" id="fechaPago" name="fecha_Pago"
                            data-format="yyyy-MM-dd" data-template="D MMM YYYY" placeholder="Ingrese el dia de pago"
                            formControlName="fecha_Pago" [(ngModel)]="contrato2.fecha_Pago">
                            <div *ngIf="formContrato.get('fecha_Pago').hasError('required') && 
                                (formContrato.get('fecha_Pago').touched || formContrato.get('fecha_Pago').dirty)"
                                class="alert alert-danger">
                                Debe seleccionar un dia para la fecha de pago.
                            </div>
                    </div>
                </div>
            </div>

            <div class="form-group row">
                <div class="col">
                    <button (click)="cancelarVenta()" class="btn btn-danger">
                        Cancelar </button>
                </div>
                <div class="col">
                    <button type="submit" (click)='saveContrato2()' class="btn btn-primary">Guardar</button>
                </div>
            </div>
            <br>
        </form>
        <br>
    </div>
</div>